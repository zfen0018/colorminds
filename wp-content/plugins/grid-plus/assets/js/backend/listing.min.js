var GridPlus=GridPlus||{};!function(i){"use strict";GridPlus={init:function(){i(".grid_plus-wrap").css("opacity",1),GridPlus.is_search=0,GridPlus.registerEvent();var r=new Clipboard(".copy-clipboard");r.on("success",function(r){i(r.trigger).find("i.fa-check").length>0&&i(r.trigger).find("i.fa-check").remove(),i(r.trigger).append('<i class="fa fa-check active"> Copied!</i>'),r.clearSelection(),setTimeout(function(){i("i.active",r.trigger).fadeOut(function(){i(this).remove()})},2e3)})},registerEvent:function(){i("a.search-layout").off("click").on("click",function(){var r=i("input",i(this).parent());r.hasClass("active")?r.removeClass("active"):(r.val(""),r.addClass("active"),setTimeout(function(){r.focus(),r.attr("placeholder","Type grid name and enter to search")},300)),i(r).on("keypress",function(r){var e=r.keyCode?r.keyCode:r.which;if("13"==e){var t=i(this).parent().parent().attr("data-ajax-url"),a=i(this).val();0==GridPlus.is_search&&(GridPlus.is_search=1,GridPlus.processSearch("Searching grid ......",t,a))}})}),i("a.export-grid").off("click").on("click",function(){GridPlus.processExportGrid(this)}),i("a.import-grid").off("click").on("click",function(){i("div.form-import").toggle()}),i("a.close-import").off("click").on("click",function(){i("div.form-import").hide()}),i(".refresh-layout").off("click").on("click",function(){if(0==GridPlus.is_search){GridPlus.is_search=1;var r=i(this).parent().attr("data-ajax-url");GridPlus.processSearch("Refresh grid ......",r,"")}}),GridPlus.registerGridAction()},registerGridAction:function(){i("a.clone-grid").off("click").on("click",function(){GridPlus.processCloneLayout(this)}),i("a.delete-grid").off("click").on("click",function(){var r=i(this);GridPlusUtil.confirmDialog("Confirm","Confirm delete layout?",function(){GridPlus.processDeleteLayout(r)})})},processDeleteLayout:function(r){var e=i(r).parent().attr("data-id"),t=i(r).parent().attr("data-ajax-url");GridPlusUtil.showLoading("Deleting layout information"),i.ajax({url:t,type:"POST",data:{action:"grid_plus_delete",grid_id:e},success:function(i){GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Information has been deleted"),GridPlusUtil.closeLoading(500),i=JSON.parse(i),GridPlus.processRebindListGrid(i)},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when delete information"),GridPlusUtil.closeLoading()}})},processRebindListGrid:function(r){var e=wp.template("list-grid-template");i("tr","#table_list_grid tbody").empty(),"undefined"!=typeof r&&r.length>0&&i("tbody","#table_list_grid").append(e(r)),GridPlus.registerGridAction()},processSearch:function(r,e,t){GridPlusUtil.showLoading(r),i.ajax({url:e,type:"POST",data:{action:"grid_plus_get_list",grid_name:t},success:function(i){GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Binding grid"),GridPlusUtil.closeLoading(500),i=JSON.parse(i),GridPlus.processRebindListGrid(i),GridPlus.is_search=0},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when delete information"),GridPlusUtil.closeLoading(),GridPlus.is_search=0}})},processExportGrid:function(r){var e=i(r).parent().attr("data-ajax-url");GridPlusUtil.showLoading("Processing export grid data"),i.ajax({url:e,type:"POST",data:{action:"grid_plus_export"},success:function(i){var r=[];r.push(i);var e=new File(r,"grid-plus.json",{type:"text/plain;charset=utf-8"});saveAs(e),GridPlusUtil.closeLoading(500)},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when exort grid"),GridPlusUtil.closeLoading()}})},processCloneLayout:function(r){var e=(i(r).parent().attr("data-id"),i(r).parent().attr("data-ajax-url"),prompt("Please enter layout name",""));if(""!=e&&null!=e){var t=i(r).attr("data-clone-url")+e;return window.location.href=t,!0}return r.preventDefault(),!1}},i(document).ready(function(){GridPlus.init()})}(jQuery);