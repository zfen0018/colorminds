var GridPlusSetting=GridPlusSetting||{};!function(b){"use strict";GridPlusSetting={vars:{grid_stack:b(".grid-stack"),custom_content_numb:0},init:function(){b(".grid-plus-wrap").css("opacity",1),GridPlusSetting.grid=null,GridPlusSetting.is_search=0,GridPlusSetting.options={cellHeight:10,verticalMargin:20,height:0,animate:!0,acceptWidgets:!0,removable:!0,width:12,resizable:{handles:"e, se, s, sw, w"}},GridPlusSetting.select_categories=null,GridPlusSetting.initControl(),GridPlusSetting.registerEvent(),GridPlusSetting.animation(),GridPlusSetting.initDepend(),GridPlusSetting.initSaveCtrS(),GridPlusSetting.registerGallery(),new Clipboard(".copy-clipboard").on("success",function(a){0<b(a.trigger).find("i.fa-check").length&&b(a.trigger).find("i.fa-check").remove(),b(a.trigger).append("<i class=\"fa fa-check active\"> Copied!</i>"),a.clearSelection(),setTimeout(function(){b("i.active",a.trigger).fadeOut(function(){b(this).remove()})},2e3)}),b(".colorpicker").wpColorPicker(),GridPlusSetting.layout_custom_css=ace.edit("layout_custom_css"),GridPlusSetting.layout_custom_css.getSession().setMode("ace/mode/css"),GridPlusSetting.layout_custom_css.setAutoScrollEditorIntoView(!0),"undefined"!=typeof grid_script_data&&""!=grid_script_data.grid_id&&GridPlusSetting.processEditLayout(),GridPlusSetting.execCustomContent()},initControl:function(){GridPlusSetting.use_image=b("#layout_use_image"),GridPlusSetting.layout_id=b("#layout_id"),GridPlusSetting.layout_shortcode=b("#layout_shortcode"),GridPlusSetting.layout_name=b("#layout_name"),GridPlusSetting.layout_type=b("#layout_type"),GridPlusSetting.layout_col=b("#layout_col"),GridPlusSetting.layout_gutter=b("#layout_gutter"),GridPlusSetting.layout_item_per_page=b("#layout_item_per_page"),GridPlusSetting.layout_total_items=b("#layout_total_items"),GridPlusSetting.layout_fix_item_height=b("#layout_fix_item_height"),GridPlusSetting.layout_crop_image=b("#layout_crop_image"),GridPlusSetting.layout_disable_link=b("#layout_disable_link"),GridPlusSetting.layout_custom_content_enable=b("#layout_custom_content_enable"),GridPlusSetting.layout_custom_content=b("#layout_custom_content"),GridPlusSetting.layout_carousel_rtl=b("#layout_carousel_rtl"),GridPlusSetting.layout_carousel_total_items=b("#layout_carousel_total_items"),GridPlusSetting.layout_carousel_desktop_large_col=b("#layout_carousel_desktop_large_col"),GridPlusSetting.layout_carousel_desktop_large_width=b("#layout_carousel_desktop_large_width"),GridPlusSetting.layout_carousel_desktop_medium_col=b("#layout_carousel_desktop_medium_col"),GridPlusSetting.layout_carousel_desktop_medium_width=b("#layout_carousel_desktop_medium_width"),GridPlusSetting.layout_carousel_desktop_small_col=b("#layout_carousel_desktop_small_col"),GridPlusSetting.layout_carousel_desktop_small_width=b("#layout_carousel_desktop_small_width"),GridPlusSetting.layout_carousel_tablet_col=b("#layout_carousel_tablet_col"),GridPlusSetting.layout_carousel_tablet_width=b("#layout_carousel_tablet_width"),GridPlusSetting.layout_carousel_tablet_small_col=b("#layout_carousel_tablet_small_col"),GridPlusSetting.layout_carousel_tablet_small_width=b("#layout_carousel_tablet_small_width"),GridPlusSetting.layout_carousel_mobile_col=b("#layout_carousel_mobile_col"),GridPlusSetting.layout_carousel_mobile_width=b("#layout_carousel_mobile_width"),GridPlusSetting.layout_carousel_next_text=b("#layout_carousel_next_text"),GridPlusSetting.layout_carousel_prev_text=b("#layout_carousel_prev_text"),GridPlusSetting.layout_carousel_width_ratio=b("#layout_carousel_width_ratio"),GridPlusSetting.layout_carousel_height_ratio=b("#layout_carousel_height_ratio"),GridPlusSetting.layout_loop=b("#layout_loop"),GridPlusSetting.layout_center=b("#layout_center"),GridPlusSetting.layout_autoplay=b("#layout_autoplay"),GridPlusSetting.layout_autoplay_hover_pause=b("#layout_autoplay_hover_pause"),GridPlusSetting.layout_autoplay_time=b("#layout_autoplay_time"),GridPlusSetting.layout_show_dot=b("#layout_show_dot"),GridPlusSetting.layout_show_nav=b("#layout_show_nav"),GridPlusSetting.layout_carousel_nav_position=b("#layout_carousel_nav_position"),GridPlusSetting.layout_carousel_nav_style=b("#layout_carousel_nav_style"),GridPlusSetting.layout_justified_row_height=b("#layout_justified_row_height"),GridPlusSetting.layout_source=b("#layout_source"),GridPlusSetting.source_type=b("#source_type"),GridPlusSetting.attachment_type=b("#attachment_type"),GridPlusSetting.grid_gallery=b("#grid_gallery"),GridPlusSetting.custom_urls=b("#custom_urls"),GridPlusSetting.layout_category=b("#layout_category"),GridPlusSetting.layout_show_category=b("#layout_show_category"),GridPlusSetting.layout_cate_multi_line=b("#layout_cate_multi_line"),GridPlusSetting.layout_authors=b("#layout_authors"),GridPlusSetting.layout_include_ids=b("#layout_include_ids"),GridPlusSetting.layout_exclude_ids=b("#layout_exclude_ids"),GridPlusSetting.layout_order=b("#layout_order"),GridPlusSetting.layout_order_by=b("#layout_order_by"),GridPlusSetting.layout_category_color=b("#layout_category_color"),GridPlusSetting.layout_category_hover_color=b("#layout_category_hover_color"),GridPlusSetting.layout_no_image_bg_color=b("#layout_no_image_bg_color"),GridPlusSetting.layout_bg_color=b("#layout_bg_color"),GridPlusSetting.layout_icon_color=b("#layout_icon_color"),GridPlusSetting.layout_icon_hover_color=b("#layout_icon_hover_color"),GridPlusSetting.layout_title_color=b("#layout_title_color"),GridPlusSetting.layout_title_hover_color=b("#layout_title_hover_color"),GridPlusSetting.layout_excerpt_color=b("#layout_excerpt_color"),GridPlusSetting.layout_animation_type=b("#layout_animation_type"),GridPlusSetting.layout_pagination_type=b("#layout_pagination_type"),GridPlusSetting.layout_page_prev_text=b("#layout_page_prev_text"),GridPlusSetting.layout_page_next_text=b("#layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=b("#layout_page_loadmore_text"),"metro"==GridPlusSetting.layout_type.val()&&(GridPlusSetting.layout_item_per_page=b("#metro_layout_item_per_page"),GridPlusSetting.layout_total_items=b("#metro_layout_total_items"),GridPlusSetting.layout_pagination_type=b("#metro_layout_pagination_type"),GridPlusSetting.layout_page_prev_text=b("#metro_layout_page_prev_text"),GridPlusSetting.layout_page_next_text=b("#metro_layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=b("#metro_layout_page_loadmore_text")),"attachment"==GridPlusSetting.layout_source.val()&&"choose_source"==GridPlusSetting.attachment_type.val()&&(GridPlusSetting.layout_authors=b("#attachment_layout_authors"),GridPlusSetting.layout_order=b("#attachment_layout_order"),GridPlusSetting.layout_order_by=b("#attachment_layout_order_by")),b("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(b("optgroup[data-post-type=\""+GridPlusSetting.layout_source.val()+"\"]","#layout_category_filter").clone()),GridPlusSetting.initSelectize()},initGridMoveAndResize:function(a){void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid&&("grid"!=a&&"masonry"!=a||GridPlusSetting.grid.disable(),"metro"==a&&GridPlusSetting.grid.enable()),"grid"==a?b(".change-ratio",".action-groups").show():b(".change-ratio",".action-groups").hide(),"metro"==a?b(".change-item-ratio",".grid-stack-item").show():b(".change-item-ratio",".grid-stack-item").hide()},registerEvent:function(){b("a.add-item").on("click",function(){GridPlusSetting.showPopupSkin(function(b){var c=GridPlusSetting.estimateItemInfo(),d=c.width,e=c.height,a=c.system_col,f=c.col;GridPlusSetting.options.width=a,GridPlusSetting.grid.setGridWidth(a,!1),GridPlusSetting.processAddItem(d,e,f,b),GridPlusSetting.processUpdateItemPerPage(1)})}),b("a.change-item-style").on("click",function(){GridPlusSetting.showPopupSkin(function(a){b(".grid-stack-item").each(function(){GridPlusSetting.processInitItemStyle(b(this),a)})})}),b("a.save-layout",".grid-plus-container").off("click").on("click",function(){GridPlusSetting.processSaveGrid(this)}),b(".grid-post-item",".list-skins").each(function(){b(this).append("<a class=\"select-skin\" href=\"javascript:;\"><i class=\"fa fa-square-o\"></i>Select</a>"),b("a.select-skin",this).off("click").on("click",function(){b("a.select-skin").html("<i class=\"fa fa-square-o\"></i>Select"),b(this).html("<i class=\"fa fa-check-square-o\"></i>Selected"),b(".grid-post-item",".list-skins").attr("data-skin-selected",0),b(this).parent().attr("data-skin-selected",1)})}),b("a.generate-layout").on("click",function(){GridPlusUtil.showLoading("Processing generate layout ..."),GridPlusSetting.vars.grid_stack.fadeOut(function(){GridPlusSetting.processGenerateLayout(),GridPlusSetting.vars.grid_stack.fadeIn(function(){GridPlusUtil.closeLoading(0)})})}),b("a.search-layout").on("click",function(){var a=b("input",b(this).parent());a.hasClass("active")?a.removeClass("active"):(a.val(""),a.addClass("active"),setTimeout(function(){a.focus(),a.attr("placeholder","Type grid name and enter to search")},300)),b(a).on("keypress",function(c){if("13"==(c.keyCode?c.keyCode:c.which)){var d=b(this).parent().parent().attr("data-ajax-url"),e=b(this).val();0==GridPlusSetting.is_search&&(GridPlusSetting.is_search=1,GridPlusSetting.processSearch("Searching grid ......",d,e))}})}),b(".refresh-layout").on("click",function(){if(0==GridPlusSetting.is_search){GridPlusSetting.is_search=1;var a=b(this).parent().attr("data-ajax-url");GridPlusSetting.processSearch("Refresh grid ......",a,"")}}),b(".change-ratio",".action-groups").on("click",function(){var c=wp.template("bg-prompt-change-height-dialog"),d=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),f=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==d&&""!=d||(d=1),void 0!==f&&""!=f||(f=1),b("body").append(c({height_ratio:d,width_ratio:f})),b("a.close-popup",".bg-popup-change-height").on("click",function(){b(".bg-popup-change-height").remove()}),b(".apply-change-height").on("click",function(){var c=b(".txt_height",".bg-popup-change-height").val(),d=b(".txt_width",".bg-popup-change-height").val(),f=b(".grid-stack-item-content",".grid-stack-item:first-child").width(),g=0;c=0>=parseInt(c)?1:c,d=0>=parseInt(d)?1:d,""!=c&&""!=d&&(GridPlusSetting.vars.grid_stack.attr("data-height-ratio",c),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",d),f=parseInt(f),c=parseInt(c),d=parseInt(d),g=Math.floor(f*(c/d))/GridPlusSetting.options.cellHeight,GridPlusSetting.processChangeHeight(g)),b(".bg-popup-change-height").remove()})}),GridPlusSetting.layout_name.keyup(function(){GridPlusSetting.layout_shortcode.text("[grid_plus name=\""+b(this).val()+"\"]")}),GridPlusSetting.registerChangeTab()},initSelectize:function(){var a,c={plugins:["remove_button","drag_drop"],searchField:"text",delimiter:",",persist:!1};b("select:not(.manual)",".grid-plus-wrap").each(function(){a=b(this).attr("data-selected"),c.items=void 0===a?[]:a.split(","),b(this).selectize(c)}),a=GridPlusSetting.layout_category.attr("data-selected"),c.items=void 0===a?[]:a.split(","),GridPlusSetting.select_categories=GridPlusSetting.layout_category.selectize(c),void 0!==GridPlusSetting.select_categories[0]&&(GridPlusSetting.select_categories=GridPlusSetting.select_categories[0].selectize),GridPlusSetting.layout_exclude_ids.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(a,c){return a.length?void b.ajax({url:GridPlusSetting.layout_exclude_ids.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:a,post_type:GridPlusSetting.layout_source.val()},error:function(){c()},success:function(a){c(b.parseJSON(a))}}):c()}}),GridPlusSetting.layout_include_ids.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(a,c){return a.length?void b.ajax({url:GridPlusSetting.layout_include_ids.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:a,post_type:GridPlusSetting.layout_source.val()},error:function(){c()},success:function(a){c(b.parseJSON(a))}}):c()}}),GridPlusSetting.layout_custom_content.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(a,c){return a.length?void b.ajax({url:GridPlusSetting.layout_custom_content.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:a,post_type:GridPlusSetting.layout_custom_content.attr("data-post-type")},error:function(){c()},success:function(a){c(b.parseJSON(a))}}):c()}})},initSaveCtrS:function(){b(window).bind("keydown",function(a){if((a.ctrlKey||a.metaKey)&&"s"===String.fromCharCode(a.which).toLowerCase())return a.preventDefault(),b("a.save-layout","#layout-config").trigger("click"),!1})},initDepend:function(){b("[data-depend-control]").each(function(){var c=b(this).attr("data-depend-control"),d=b("#"+c),e="",f=","+b(this).attr("data-depend-value")+",",g=","+b(this).attr("data-depend-dif-value")+",";void 0!==d&&0<d.length&&(e=d.val(),d.is(":checkbox")&&(e=d.is(":checked")),d.is(":radio")&&(e=b("#"+c+":checked").val()),0<=f.indexOf(","+e+",")?b(this).css({display:"inline-block"}):",undefined,"!=g&&0>g.indexOf(","+e+",")?b(this).css({display:"inline-block"}):b(this).css({display:"none"}),d.off("change").on("change",function(c){if(c.preventDefault(),"layout_type"!=b(this).attr("id")&&"layout_custom_content_enable"!=b(this).attr("id")||GridPlusSetting.execCustomContent(),"layout_type"==b(this).attr("id")){var d=b(this).val();"grid"==d?b(".change-ratio",".action-groups").show():b(".change-ratio",".action-groups").hide(),"metro"==d?b(".change-item-ratio",".grid-stack-item").show():b(".change-item-ratio",".grid-stack-item").hide(),GridPlusSetting.initGridMoveAndResize(d)}if("layout_source"==b(this).attr("id")){var e=b(this).val();GridPlusSetting.select_categories.destroy(),b("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(b("optgroup[data-post-type=\""+e+"\"]","#layout_category_filter").clone()),GridPlusSetting.initSelectize()}GridPlusSetting.initDepend()}))})},initGridStack:function(c,d,e,a){b("select[name=\"padding\"]").val();var f=GridPlusSetting.estimateItemInfo(),g=f.width,h=f.height,i=f.system_col;a=parseInt(a),GridPlusSetting.options.verticalMargin=a,GridPlusSetting.options.width=i,GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+a),GridPlusSetting.vars.grid_stack.attr("data-layout",c),GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(a,!0),GridPlusSetting.grid.removeAll();for(var j=0;j<e;j++)GridPlusSetting.processAddItem(g,h,d)},initGridStackEdit:function(c,d,e,a,f,g){var h=GridStackUI.Utils.sort(c,1),j=null;GridPlusSetting.vars.grid_stack.attr("data-height-ratio",a),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",f),GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+d),GridPlusSetting.vars.grid_stack.attr("data-layout",g),"grid"==g||"masonry"==g||5==e?(GridPlusSetting.options.width=e,GridPlusSetting.vars.grid_stack.addClass("grid-stack-"+e)):GridPlusSetting.options.width=12,"metro"==g?b(".change-item-ratio",".grid-stack-item").show():b(".change-item-ratio",".grid-stack-item").hide(),GridPlusSetting.options.verticalMargin=d,GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(d,!1),GridPlusSetting.grid.removeAll(),_.each(h,function(a){j=GridPlusSetting.grid.addWidget(b("<div><div class=\"grid-stack-item-content\" /></div>"),a.x,a.y,a.width,a.height),GridPlusSetting.registerRemoveGridStackItem(j),GridPlusSetting.registerChangeItemStyle(j),GridPlusSetting.registerChangeItemRatio(j),GridPlusSetting.processInitItemStyle(j,a.skin,a.item_width_ratio,a.item_height_ratio)},this)},registerRemoveGridStackItem:function(a){b(".grid-stack-item-content",a).append("<a class=\"remove-item\" title=\"Remove item\"><i class=\"fa fa-trash-o\"></i></a>"),b("a",a).off("click").on("click",function(){GridPlusSetting.grid.removeWidget(a),GridPlusSetting.processUpdateItemPerPage(-1)})},registerChangeItemRatio:function(a){b(".grid-stack-item-content",a).append("<div class=\"change-item-ratio\"><a href=\"javascript:;\" title=\"Change item ratio\"><i class=\"fa fa-qrcode\"></i></a>"),b(".change-item-ratio a",a).off("click").on("click",function(){var c=b(this).closest(".grid-stack-item"),f=c.children(".grid-stack-item-content"),d=wp.template("bg-prompt-change-item-height-dialog"),a=c.attr("data-item-height-ratio"),e=c.attr("data-item-width-ratio");void 0!==a&&""!=a||(a=1),void 0!==e&&""!=e||(e=1),b("body").append(d({height_ratio:a,width_ratio:e})),b("a.close-popup",".bg-popup-change-item-height").on("click",function(){b(".bg-popup-change-item-height").remove()}),b(".apply-change-item-height",".bg-popup-change-item-height").on("click",function(){var e=b(".txt_height",".bg-popup-change-item-height").val(),g=b(".txt_width",".bg-popup-change-item-height").val(),h=f.width(),i=f.height(),j=c.attr("data-gs-height"),k=Math.ceil(i/j),m=0,n=0;e=0>=parseInt(e)?1:e,g=0>=parseInt(g)?1:g,""!=e&&""!=g&&(c.attr("data-item-height-ratio",e),c.attr("data-item-width-ratio",g),h=parseInt(h),e=parseInt(e),g=parseInt(g),n=Math.floor(h*(e/g)),m=Math.floor(n/k),GridPlusSetting.processChangeItemHeight(c,m)),b(".bg-popup-change-item-height").remove()})})},registerChangeItemStyle:function(a){b(".grid-stack-item-content",a).append("<div class=\"change-style\"><a href=\"javascript:;\" title=\"Change skin\"><i class=\"fa fa-paint-brush\"></i></a>"),b(".change-style a",a).off("click").on("click",function(){GridPlusSetting.showPopupSkin(function(b){GridPlusSetting.processInitItemStyle(a,b)})})},registerChangeTab:function(){b("a",".grid-plus-wrap .nav-tabs").on("click",function(){var c=b(this).attr("data-section-id");void 0!==c&&(b("li",".grid-plus-wrap .nav-tabs").removeClass("tab-current"),void 0===b(this).attr("data-external")?b(this).parent().addClass("tab-current"):b("a[data-section-id=\""+c+"\"]",".grid-plus-wrap .nav-tabs").parent().addClass("tab-current"),b("section",".grid-plus-wrap .content-wrap").hide(),b("#"+c,".grid-plus-wrap .content-wrap").show())})},registerGallery:function(){b(".sf-field-gallery-inner",".grid-plus-wrap").each(function(){new SF_GalleryClass(b(this)).init()})},estimateItemInfo:function(){var c=parseInt(GridPlusSetting.layout_col.val()),f=Math.floor(12/c),g=Math.floor(12/c),h=GridPlusSetting.layout_type.val(),i=GridPlusSetting.layout_gutter.val(),j=b(".grid-stack-container").width(),k=Math.floor(parseInt(j)/c),l=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),m=GridPlusSetting.vars.grid_stack.attr("data-width-ratio"),n=12;return("grid"!=h&&"masonry"!=h&&5!=c||(f=1,n=c),"grid"==h)?g=void 0!==l&&void 0!==m&&""!=m&&""!=l?Math.floor(k*(l/m)/GridPlusSetting.options.cellHeight):Math.floor(k/GridPlusSetting.options.cellHeight):2===c?g=0<i?15:40:3===c||4===c?g=0<i?15:30:5===c||6===c?g=0<i?10:20:void 0,{width:f,height:g,system_col:n,col:c}},processSaveGrid:function(f){if("carousel"!=GridPlusSetting.layout_type.val()&&"justified"!=GridPlusSetting.layout_type.val()){if(void 0===GridPlusSetting.grid||0==b(".grid-stack-item",".grid-stack").length)return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout before save");if(!GridPlusSetting.isValidateLayout())return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout when change layout type before save")}GridPlusUtil.showLoading("Save Grid Settings"),"metro"==GridPlusSetting.layout_type.val()?(GridPlusSetting.layout_item_per_page=b("#metro_layout_item_per_page"),GridPlusSetting.layout_total_items=b("#metro_layout_total_items"),GridPlusSetting.layout_pagination_type=b("#metro_layout_pagination_type"),GridPlusSetting.layout_page_prev_text=b("#metro_layout_page_prev_text"),GridPlusSetting.layout_page_next_text=b("#metro_layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=b("#metro_layout_page_loadmore_text")):(GridPlusSetting.layout_item_per_page=b("#layout_item_per_page"),GridPlusSetting.layout_total_items=b("#layout_total_items"),GridPlusSetting.layout_pagination_type=b("#layout_pagination_type"),GridPlusSetting.layout_page_prev_text=b("#layout_page_prev_text"),GridPlusSetting.layout_page_next_text=b("#layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=b("#layout_page_loadmore_text")),"attachment"==GridPlusSetting.layout_source.val()&&"choose_source"==GridPlusSetting.attachment_type.val()&&(GridPlusSetting.layout_authors=b("#attachment_layout_authors"),GridPlusSetting.layout_order=b("#attachment_layout_order"),GridPlusSetting.layout_order_by=b("#attachment_layout_order_by"));var i="thumbnail";0<b(".grid-post-item[data-skin-selected=\"1\"]",".list-skins").length&&(i=b(".grid-post-item[data-skin-selected=\"1\"]",".list-skins").closest(".skin-item").attr("data-skin"));var j="all";"post"==GridPlusSetting.layout_source.val()?(j=b("#layout_source_filter").val(),GridPlusSetting.layout_order=b("#layout_order"),GridPlusSetting.layout_order_by=b("#layout_order_by")):"product"==GridPlusSetting.layout_source.val()?(j=b("#layout_product_source_filter").val(),GridPlusSetting.layout_order=b("#layout_product_order"),GridPlusSetting.layout_order_by=b("#layout_product_order_by")):(GridPlusSetting.layout_order=b("#layout_order"),GridPlusSetting.layout_order_by=b("#layout_order_by"));var k=GridPlusSetting.layout_carousel_next_text.val(),m=GridPlusSetting.layout_carousel_prev_text.val(),q=GridPlusSetting.layout_page_loadmore_text.val(),t=GridPlusSetting.layout_page_next_text.val(),v=GridPlusSetting.layout_page_prev_text.val();void 0!==k&&(k=k.replace(/"/g,"&quot;")),void 0!==m&&(m=m.replace(/"/g,"&quot;")),void 0!==q&&(q=q.replace(/"/g,"&quot;")),void 0!==t&&(t=t.replace(/"/g,"&quot;")),void 0!==v&&(v=v.replace(/"/g,"&quot;"));var w=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),x=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==w&&""!=w&&0!=w||(w=1),void 0!==x&&""!=x&&0!=x||(x=1),0>GridPlusSetting.layout_gutter.val()&&GridPlusSetting.layout_gutter.val(0),70<GridPlusSetting.layout_gutter.val()&&GridPlusSetting.layout_gutter.val(70),GridPlusSetting.vars.custom_content_numb=0;var z=GridPlusSetting.vars.grid_stack.height(),g=_.map(b(".grid-stack > .grid-stack-item"),function(c){var d=(c=b(c)).data("_gridstack_node");"custom-content"==c.attr("data-skin")&&GridPlusSetting.vars.custom_content_numb++;var e=c.attr("data-item-width-ratio"),f=c.attr("data-item-height-ratio");return void 0!==e&&void 0!==f||(e=c.children(".grid-stack-item-content").width(),f=c.height()),e=0>=e?1:e,f=0>=f?1:f,{x:d.x,y:d.y,width:d.width,height:d.height,skin:c.attr("data-skin"),skin_css:c.attr("data-skin-css"),template:c.attr("data-skin-template"),item_width_ratio:e,item_height_ratio:f}},this),A={id:GridPlusSetting.layout_id.val(),name:GridPlusSetting.layout_name.val(),height:z,height_ratio:w,width_ratio:x,type:GridPlusSetting.layout_type.val(),columns:GridPlusSetting.layout_col.val(),gutter:GridPlusSetting.layout_gutter.val(),item_per_page:GridPlusSetting.layout_item_per_page.val(),total_item:GridPlusSetting.layout_total_items.val(),fix_item_height:GridPlusSetting.layout_fix_item_height.is(":checked"),crop_image:GridPlusSetting.layout_crop_image.is(":checked"),use_image:GridPlusSetting.use_image.val(),disable_link:GridPlusSetting.layout_disable_link.is(":checked"),custom_content_enable:GridPlusSetting.layout_custom_content_enable.is(":checked"),custom_content:GridPlusSetting.layout_custom_content.val(),custom_content_numb:GridPlusSetting.vars.custom_content_numb,loop:GridPlusSetting.layout_loop.is(":checked"),center:GridPlusSetting.layout_center.is(":checked"),justified_row_height:GridPlusSetting.layout_justified_row_height.val(),main_skin:i,carousel_rtl:GridPlusSetting.layout_carousel_rtl.is(":checked"),carousel_height_ratio:GridPlusSetting.layout_carousel_height_ratio.val(),carousel_width_ratio:GridPlusSetting.layout_carousel_width_ratio.val(),carousel_next_text:k,carousel_prev_text:m,carousel_total_items:GridPlusSetting.layout_carousel_total_items.val(),carousel_desktop_large_col:GridPlusSetting.layout_carousel_desktop_large_col.val(),carousel_desktop_large_width:GridPlusSetting.layout_carousel_desktop_large_width.val(),carousel_desktop_medium_col:GridPlusSetting.layout_carousel_desktop_medium_col.val(),carousel_desktop_medium_width:GridPlusSetting.layout_carousel_desktop_medium_width.val(),carousel_desktop_small_col:GridPlusSetting.layout_carousel_desktop_small_col.val(),carousel_desktop_small_width:GridPlusSetting.layout_carousel_desktop_small_width.val(),carousel_tablet_col:GridPlusSetting.layout_carousel_tablet_col.val(),carousel_tablet_width:GridPlusSetting.layout_carousel_tablet_width.val(),carousel_tablet_small_col:GridPlusSetting.layout_carousel_tablet_small_col.val(),carousel_tablet_small_width:GridPlusSetting.layout_carousel_tablet_small_width.val(),carousel_mobile_col:GridPlusSetting.layout_carousel_mobile_col.val(),carousel_mobile_width:GridPlusSetting.layout_carousel_mobile_width.val(),autoplay:GridPlusSetting.layout_autoplay.is(":checked"),autoplay_hover_pause:GridPlusSetting.layout_autoplay_hover_pause.is(":checked"),autoplay_time:GridPlusSetting.layout_autoplay_time.val(),show_dot:GridPlusSetting.layout_show_dot.is(":checked"),show_nav:GridPlusSetting.layout_show_nav.is(":checked"),carousel_nav_position:GridPlusSetting.layout_carousel_nav_position.val(),carousel_nav_style:GridPlusSetting.layout_carousel_nav_style.val(),animation_type:GridPlusSetting.layout_animation_type.val(),pagination_type:GridPlusSetting.layout_pagination_type.val(),page_next_text:t,page_prev_text:v,page_loadmore_text:q,category_color:GridPlusSetting.layout_category_color.val(),category_hover_color:GridPlusSetting.layout_category_hover_color.val(),no_image_background_color:GridPlusSetting.layout_no_image_bg_color.val(),background_color:GridPlusSetting.layout_bg_color.val(),icon_color:GridPlusSetting.layout_icon_color.val(),icon_hover_color:GridPlusSetting.layout_icon_hover_color.val(),title_color:GridPlusSetting.layout_title_color.val(),title_hover_color:GridPlusSetting.layout_title_hover_color.val(),excerpt_color:GridPlusSetting.layout_excerpt_color.val(),custom_css:GridPlusSetting.layout_custom_css.getValue()},p={post_type:GridPlusSetting.layout_source.val(),source_type:GridPlusSetting.source_type.val(),grid_gallery:GridPlusSetting.grid_gallery.val(),categories:GridPlusSetting.layout_category.val(),show_category:GridPlusSetting.layout_show_category.val(),cate_multi_line:GridPlusSetting.layout_cate_multi_line.is(":checked"),authors:GridPlusSetting.layout_authors.val(),include_ids:GridPlusSetting.layout_include_ids.val(),exclude_ids:GridPlusSetting.layout_exclude_ids.val(),source_filter:j,attachment_type:GridPlusSetting.attachment_type.val(),custom_urls:GridPlusSetting.custom_urls.val(),order:GridPlusSetting.layout_order.val(),order_by:GridPlusSetting.layout_order_by.val()},y=b(f).parent().attr("data-ajax-url");g=_.sortBy(g,function(a){return a.y}),g=GridStackUI.Utils.sort(g),b.ajax({url:y,type:"POST",data:{action:"grid_plus_save_layout",grid_config:A,grid_data_source:p,grid_layout:g},success:function(a){void 0!==(a=JSON.parse(a)).code&&"-1"==a.code?(GridPlusUtil.closeLoading(0),GridPlusUtil.popupAlert("fa fa-exclamation-triangle",a.message)):(GridPlusSetting.layout_id.val(a.id),GridPlusSetting.layout_shortcode.val("[grid_plus name=\""+GridPlusSetting.layout_name.val()+"\"]"),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Grid setting saved"),GridPlusUtil.closeLoading())},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when save information"),GridPlusUtil.closeLoading()}})},processGenerateLayout:function(){var c=b("#layout_name").val(),d=b("#layout_type").val(),e=b("#layout_col").val(),f=b("#layout_item_per_page").val(),g=b("#layout_total_items").val(),h=b("#layout_gutter").val(),i="grid-stack-"+e;"show_all"==b("#layout_pagination_type").val()&&(f=2*e),b("#grid_id",".grid-plus-layout").val(),b("#grid_name",".grid-plus-layout").val(c),b("#grid_type",".grid-plus-layout").val(d),b("#grid_col",".grid-plus-layout").val(e),b("#grid_gutter",".grid-plus-layout").val(h),b("#grid_item_per_page",".grid-plus-layout").val(f),b("#grid_items",".grid-plus-layout").val(g);for(var j=1;12>=j;j++)GridPlusSetting.vars.grid_stack.removeClass("grid-stack-"+j);"metro"==d&&5!=e||GridPlusSetting.vars.grid_stack.addClass(i),e=parseInt(e),f=parseInt(f),GridPlusSetting.initGridStack(d,e,f,h),GridPlusSetting.initGridMoveAndResize(d)},processAddItem:function(f,h,e,a){var i=b(".grid-stack-item:last-child"),j=0,k=0,m=f,q=0,r=0,t=b(".grid-stack-item").length;void 0!==i&&0<i.length&&(j=i.attr("data-gs-y"),k=i.attr("data-gs-x"),m=i.attr("data-gs-width"),0==t%e?(q=0,r=Math.floor(t/e)*h):(r=j,q=parseInt(k)+parseInt(m)));var v={x:q,y:r,width:f,height:h};void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid||(GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"));var g=GridPlusSetting.grid.addWidget(b("<div><div class=\"grid-stack-item-content stack-item-has-bg\"/></div>"),v.x,v.y,v.width,v.height,!1);if(void 0===a||""==a){var c=b(".grid-post-item[data-skin-selected=\"1\"]",".list-skins");a="thumbnail",0<c.length&&(a=c.closest(".skin-item").attr("data-skin"))}GridPlusSetting.registerRemoveGridStackItem(g),GridPlusSetting.registerChangeItemStyle(g),GridPlusSetting.registerChangeItemRatio(g),GridPlusSetting.processInitItemStyle(g,a,1,1)},processInitItemStyle:function(c,f,e,a){var g,h,i,j,k=b(".grid-stack-item-content",c),l=b("li[data-skin=\""+f+"\"]",".list-skins"),m=b(".grid-post-item",l);0==m.length&&(l=b("li:first-child",".list-skins"),m=b(".grid-post-item:first-child",".list-skins")),g=l.attr("data-skin"),i=l.attr("data-skin-css"),h=l.attr("data-skin-template"),m=m.clone(),void 0!==(j=b(".thumbnail-image",m).attr("data-img"))&&""!=j&&(b(".thumbnail-image img",m).remove(),b(".thumbnail-image",m).css("background-image","url(\""+j+"\")")),b("a.select-skin",m).remove(),c.fadeOut(function(){0<b(".grid-post-item",c).length&&b(".grid-post-item",c).remove(),c.attr("data-skin",g),c.attr("data-skin-css",i),c.attr("data-skin-template",h),c.attr("data-item-height-ratio",a),c.attr("data-item-width-ratio",e),k.append(m),c.fadeIn()})},processUpdateItemPerPage:function(a){var c=b("#layout_item_per_page").val();b("#layout_item_per_page").val(parseInt(c)+a),b("#grid_item_per_page",".grid-plus-layout").val(parseInt(c)+a)},processEditLayout:function(){GridPlusUtil.showLoading("Loading layout information"),b.ajax({url:grid_script_data.ajax_url,type:"POST",data:{action:"grid_plus_get_info",grid_id:grid_script_data.grid_id},success:function(c){var d=JSON.parse(c);if("-1"==typeof d.code)return GridPlusUtil.closeLoading(0),void GridPlusUtil.popupAlert("fa fa-exclamation-triangle",d.message);if(void 0!==d.grid_config){var e=b(".skin-item[data-skin=\""+d.grid_config.main_skin+"\"]",".list-skins");0<e.length&&(b(".grid-post-item",e).attr("data-skin-selected",1),b(".select-skin",e).html("<i class=\"fa fa-check-square-o\"></i>Selected"))}GridPlusSetting.initGridStackEdit(d.grid_layout,d.grid_config.gutter,d.grid_config.columns,d.grid_config.height_ratio,d.grid_config.width_ratio,d.grid_config.type),GridPlusSetting.initGridMoveAndResize(d.grid_config.type),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Information has been loaded"),GridPlusUtil.closeLoading(500)},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when load information"),GridPlusUtil.closeLoading()}})},processRebindListGrid:function(a){var c=wp.template("list-grid-template");b("tr","#table_list_grid tbody").empty(),void 0!==a&&0<a.length&&b("tbody","#table_list_grid").append(c(a)),GridPlusSetting.registerGridAction()},processSearch:function(c,d,e){GridPlusUtil.showLoading(c),b.ajax({url:d,type:"POST",data:{action:"grid_plus_get_list",grid_name:e},success:function(a){GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Binding grid"),GridPlusUtil.closeLoading(500),a=JSON.parse(a),GridPlusSetting.processRebindListGrid(a),GridPlusSetting.is_search=0},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when delete information"),GridPlusUtil.closeLoading(),GridPlusSetting.is_search=0}})},processChangeHeight:function(c){var d=0,f=0,g=0,h=0;b(".grid-stack-item").each(function(){h=parseInt(b(this).attr("data-gs-height")),d=c-h,f=parseInt(b(this).attr("data-gs-y")),g=parseInt(b(this).attr("data-gs-width")),b(this).attr("data-gs-height",c),0<f&&b(this).attr("data-gs-y",f+d),void 0!==GridPlusSetting.grid&&GridPlusSetting.grid.resize(b(this),g,c)}),void 0!==GridPlusSetting.grid&&(GridPlusSetting.grid.batchUpdate(),GridPlusSetting.grid.commit())},processChangeItemHeight:function(c,d){var e,f,g;e=d-parseInt(c.attr("data-gs-height")),f=parseInt(c.attr("data-gs-y")),g=parseInt(c.attr("data-gs-width")),c.attr("data-gs-height",d),0<f&&b(this).attr("data-gs-y",f+e),void 0!==GridPlusSetting.grid&&GridPlusSetting.grid.resize(c,g,d)},isValidateLayout:function(){var c=GridPlusSetting.layout_type.val(),d=(GridPlusSetting.layout_col,b(".grid-stack-item"));if("grid"==c||"masonry"==c)for(var e=0;e<d.length;e++)if(0<b(d[e]).prev().length&&parseInt(b(d[e]).attr("data-gs-width"))!=parseInt(b(d[e]).prev().attr("data-gs-width")))return!1;return!0},showPopupSkin:function(c){var d=b("#list_skins").clone(!0),e=b("<div class=\"grid-plus-container\"></div>"),a=b("<div class=\"bg-popup-skins\"></div>");b("li",d).removeClass("col-md-3").addClass("col-md-4"),e.append(d),a.append(e),e.append("<a href=\"javascript:;\" class=\"close-popup\"><i class=\"fa fa-times\"></i></a>"),b(".select-skin i",e).removeClass("fa fa-check-square-o").addClass("fa fa-square-o"),b("body").append(a),b(".grid-plus-container .grid-plus-layout",a).perfectScrollbar({wheelSpeed:.5,suppressScrollX:!0}),b("a.close-popup",a).on("click",function(){a.remove()}),b("a.select-skin",a).off("click").on("click",function(d){return a.remove(),c&&c(b(this).closest(".skin-item").attr("data-skin")),d.preventDefault(),!1})},animation:function(){b("#layout_animation_type").on("change",function(){var a=b(".animation-wrap");a.attr("class","animation-wrap animated "+b(this).val()),setTimeout(function(){a.attr("class","animation-wrap")},1e3)}),b(".preview-animation").on("click",function(){b("#layout_animation_type").trigger("change")})},execCustomContent:function(){var c=b("#layout_type").val(),d=b("#layout_custom_content_enable").is(":checked"),e=b("[data-skin=\"custom-content\"]",".list-skins");"metro"==c&&("true"==d||d)?e.css("display","inline-block"):(e.css("display","none"),"1"==b(".grid-post-item",e).attr("data-skin-selected")&&b(".select-skin",".list-skins [data-skin=\"thumbnail\"]").trigger("click"))}},b(document).ready(function(){GridPlusSetting.init()})}(jQuery);